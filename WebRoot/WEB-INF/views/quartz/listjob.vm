<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head>
	 #parse("common/common.vm")
	<script type="text/javascript" src="resource/js/quartz/listjob.js"></script>
    <title>任务列表</title>
    <style type="text/css">
    	table{width: 90%;margin: 0 auto;text-align: center;border-right:1px solid #999;border-bottom: 1px solid #999;}
    	table tr{}
    	table td,table th{border-left: 1px solid #999;border-top: 1px solid #999;}
    	.btn{border: 0;border-radius:4px;background-color: #428bca;color: #fff;padding: 3px 5px;cursor: pointer;}
    </style>
</head>
<body style="background: beige;">
  <h2 style="text-align: center;">任务列表</h2>
  <table id="table_report" class="table table-striped table-bordered table-hover" cellpadding="0" cellspacing="0">
    <thead>
        <tr>
            <!-- th class="center">序号</th-->
            <th class="center">任务组名称</th>
            <th class="center">定时任务名称</th>
             <th class="center">触发器组名称</th>
            <th class="center">触发器名称</th> 
            <th class="center">时间表达式</th>
            <th class="center">上次运行时间</th>
            <th class="center">下次运行时间</th>
            <th class="center">任务状态</th>
            <th class="center">已经运行时间</th> 
             <th class="center">持续运行时间</th> 
            <th class="center">开始时间</th>
            <th class="center">结束时间</th>
            <th class="center">任务类名</th>
             <th class="center">方法名称</th>
            <th class="center">jobObject</th> 
             <th class="center">运行次数</th> 
            <th class="center" width="15%">操作</th>
        </tr>
    </thead>
    <tbody>
        <!-- 开始循环 -->
		#if(!$jobInfos && $jobInfos.size > 0)
			#foreach($jobInfo in $jobInfos)
            <c:forEach items="${jobInfos}" var="var" varStatus="vs">
                <tr>
                    <td class='center' style="width: auto;">$jobInfo.jobGroup</td>
                    <td class='center' style="width: auto;">$jobInfo.jobName</td>
                    <td class='center' style="width: auto;">$jobInfo.triggerGroupName</td>
                    <td class='center' style="width: auto;">$jobInfo.triggerName</td> 
                    <td class='center' style="width: auto;">$jobInfo.cronExpr</td>
                    <td class='center' style="width: auto;">$jobInfo.previousFireTime</td>
                    <td class='center' style="width: auto;">$jobInfo.nextFireTime</td>
                    <td class='center' style="width: auto;">
						#if($jobInfo.jobStatus == 'NONE')
							<span class="label">未知</span>
						#end
						#if($jobInfo.jobStatus == 'NORMAL')
							<span class="label label-success arrowed">正常运行</span>
						#end
						#if($jobInfo.jobStatus == 'PAUSED')
							<span class="label label-warning">暂停状态</span>
						#end
						#if($jobInfo.jobStatus == 'COMPLETE')
							<span class="label label-important arrowed-in">完成状态</span>
						#end
						#if($jobInfo.jobStatus == 'ERROR')
							<span class="label label-info arrowed-in-right arrowed">错误状态</span>
						#end
						#if($jobInfo.jobStatus == 'BLOCKED')
							<span class="label label-inverse">锁定状态</span>
                        #end
                    </td>
                    <td class='center' style="width: auto;">$jobInfo.runTimes</td>
                    <td class='center' style="width: auto;">$jobInfo.duration</td>
                    <td class='center' style="width: auto;">$jobInfo.startTime</td>
                    <td class='center' style="width: auto;">$jobInfo.endTime</td>
                    <td class='center' style="width: auto;">$jobInfo.jobClass</td>
                    <td class='center' style="width: auto;">$jobInfo.jobMethod</td>
                    <td class='center' style="width: auto;">$jobInfo.jobObject</td>
                    <td class='center' style="width: auto;">$jobInfo.count</td>
                    <td class='center' style="width: auto;">
                        <a class="btn btn-minier btn-info" onclick="triggerJob('${jobInfo.jobName}','${jobInfo.jobGroup}');"><i class="icon-edit"></i>运行</a>
                        <a class="btn btn-minier btn-success" onclick="edit('${jobInfo.jobName}','${jobInfo.jobGroup}');"><i class="icon-edit"></i>编辑</a><br>
                        <a class="btn btn-minier btn-warning" onclick="pauseJob('${jobInfo.jobName}','${jobInfo.jobGroup}');"><i class="icon-edit"></i>暂停</a>
                        <a class="btn btn-minier btn-purple" onclick="resumeJob('${jobInfo.jobName}','${jobInfo.jobGroup}');"><i class="icon-edit"></i>恢复</a>
                        <a class="btn btn-minier btn-danger" onclick="deleteJob('${jobInfo.jobName}','${jobInfo.jobGroup}','${jobInfo.triggerName}','${jobInfo.triggerGroupName}');"><i class="icon-edit"></i>删除</a>
                    </td>
                </tr>
            #end
         #else
            <tr class="main_info">
                <td colspan="100" class="center">没有相关数据</td>
            </tr>
         #end
    </tbody>
</table>
<div style="width: 90%;margin: 0 auto;text-align: center;margin-top: 25px;">
	<button type="button" onclick="add();" class="btn">新增任务</button>
</div>
</body>
</html>
